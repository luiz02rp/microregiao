---
title: "Untitled"
format: html
editor_options: 
  chunk_output_type: console
---

```{r}
library(tidyverse)
library(rstatix)
library(flextable)
library(MKinfer)
library(gtsummary)
```

# Estatística descritiva
```{r}
tabela_descritiva <- df_t |> 
  group_by(nivel_atencao) |> 
  summarise(n = n(), media = mean(pop_vinculo, na.rm = T), desvio_padrao = sd(pop_vinculo, na.rm = T)) |> 
  flextable() |> 
  set_header_labels(nivel_atencao = "Nível assistencial", n = "Nº de municípios", media = "Média", desvio_padrao = "Desvio-Padrão") |> 
  colformat_double(digits = 2, big.mark = ".", decimal.mark = ",") |> 
  autofit() |> 
  set_caption("Habitantes por Psicólogo por Nível de Atenção")
```

# Pressupostos
```{r}
## normalidade dos dados
df_t |> 
    group_by(nivel_atencao) |> 
    shapiro_test(pop_vinculo) |> 
    flextable() |> 
    set_header_labels(nivel_atencao = "Nível assistencial", variable = "Variável", statistic = "Estatística", p = "p-valor") |> 
    colformat_double(digits = 2, big.mark = ".", decimal.mark = ",") |> 
    autofit() |> 
    set_caption("Teste de Shapiro-Wilk para normalidade")
    
## homogeneidade de variâncias
levene_test(df_t, pop_vinculo ~ nivel_atencao, center = "median") |> 
    flextable() |> 
    colformat_double(digits = 2, big.mark = ".", decimal.mark = ",") |> 
    autofit() |> 
    set_caption("Teste de Levene para homogeneidade de varâncias")
```

# Teste t com bootstrapp
```{r}
# teste t com bootstrapp
df_t |> 
  filter(nivel_atencao == "atenção secundária")

t_test_robusto <- boot.t.test(pop_vinculo ~ nivel_atencao, df_t, R = 1000)
```

Embora a atenção primária está presente em todo o território da microrregião, o que difere da atenção secundária, a qual se concentra em determinadas localidades. Entretanto, eles não apresentaram uma diferença estatisticamente significativa. 

# Tamanho de efeito
```{r}
# efeito
efeito <- cohens_d(data = df_t, formula = pop_vinculo ~ nivel_atencao, var.equal = T, hedges.correction = F)
```

# procedimento de análise de dados
Foi realizado um teste t de Student para amostras independentes com o objetivo de investigar em que medida a cobertura de psicólogos era diferente entre os níveis primária e secundário. A normalidade dos dados foi avaliada por meio do teste Shapiro-Wilk. O pressuposto de homogeneidade de variância foi avaliado por meio do teste de Levene. Foram realizados procedimentos de bootstrapping (1000 re-amostragens; 95% IC) para se obter uma maior confiabilidade dos resultados, para corrigir desvios de normalidade da distribuição da amostra, diferenças entre os tamanhos dos grupos e para apresentar um intervalo de confiança de 95% para as diferenças entre as médias (Haukoos & Lewis, 2005).

# resultados
Os resultados indicaram desvio de normalidade para a cobertura de psicólogos na atenção secundária. Além disso, observou-se a existência de psicólogos atuando na atenção primária em todos os 24 municípios da microrregião, mas apenas 18 cidades contavam com a presença de tais profissionais no nível secundário (ver tabela x). Embora exista essa diferença, a relação entre  vínculo de psicólogos por habitantes não apresentou diferença significativa (*t*(25,37) = -1,44, *p* = 0,09) [IC 95% -8966,91, 636,87], com tamanho de efeito pequeno (d de Cohen = 0,48). 